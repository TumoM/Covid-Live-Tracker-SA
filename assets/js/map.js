var tooltip,tooltipText,tooltipRects,provinceList={"NORTH WEST":"ZA-NW","EASTERN CAPE":"ZA-EC","FREE TATE":"ZA-FS",MPUMALANGA:"ZA-MP","NORTHERN CAPE":"ZA-NC",LIMPOPO:"ZA-LP","WESTERN CAPE":"ZA-WC",GAUTENG:"ZA-GT","KWAZULU-NATAL":"ZA-NL",UNALLOCATED:"ZA-UN"},width=415,legendTitle=$("#legTitle")[0],xPen=92,yPen=220,legendSet=!1,colourVal=1,provCase={},provDeath={},provRecoveries={},cardList=[];function displayName(t){document.getElementById("country-name").firstChild.data=t}console.log("In Main"),cardList=[],function(){tooltip=document.getElementById("country-name"),tooltipText=tooltip.getElementsByTagName("text")[0],tooltipRects=tooltip.getElementsByTagName("rect");for(var t=0;t<tooltipRects.length;t++)tooltipRects[t].setAttributeNS(null,"width",width)}();for(var svg=document.getElementById("svg-1"),triggers=document.getElementsByClassName("tooltip-trigger"),i=0;i<triggers.length;i++)triggers[i].addEventListener("mousemove",showTooltip),triggers[i].addEventListener("mouseout",hideTooltip);let x,y;function showTooltip(t){svg.getScreenCTM();let e=t.target.getAttributeNS(null,"id");tooltipText.firstChild.data=t.target.getAttributeNS(null,"title"),tooltip.setAttributeNS(null,"transform","translate(10 390)");var o=tooltipText.getComputedTextLength();tooltipText.setAttributeNS(null,"x",(width-o)/2),$("#casesTooltip").text(CommaFormatted(provCase[e])),$("#deathsTooltip").text(CommaFormatted(provDeath[e])),$("#recoveryTooltip").text(CommaFormatted(provRecoveries[e])),tooltip.style.opacity=1}function hideTooltip(){tooltip.style.opacity=0}function colourCountry(t,e,o){var r=document.getElementById(t);$("#"+t).removeClass(),$("#"+t).addClass("land tooltip-trigger valid"),r.classList.add("colour"+o+e)}function colourCountries(t,e=1){for(var o=0;o<t.length;o++)for(var r=0;r<t[o].length;r++)colourCountry(t[o][r],o,e)}function legendSetup(t,e,o){o=Math.round(o);let r=$(".keyText"),s=$(".key.legend");s.removeClass(),s.addClass("key legend");for(let t=0;t<5;t++)s[t].classList.add("colour"+colourVal+t);if(r[0].textContent="0 to "+CommaFormatted(e),r[1].textContent=`${CommaFormatted(e+1)} to ${CommaFormatted(e+o)}`,r[2].textContent=`${CommaFormatted(t-3*o+1)} to ${CommaFormatted(t-2*o)}`,r[3].textContent=`${CommaFormatted(t-2*o+1)} to ${CommaFormatted(t-o)}`,r[4].textContent=`${CommaFormatted(t-o+1)} to ${CommaFormatted(t)}`,console.log("Legend Set:",legendSet),!legendSet){let t=$("rect.key:nth-child(7)")[0].getBoundingClientRect().width+$("text.keyText:nth-child(12)")[0].getBoundingClientRect().width;console.log("WIDTH:",t),$(".lightBack").width("55%");let e=legendTitle.getComputedTextLength();legendTitle.setAttributeNS(null,"x",(t-e)/2-xPen),legendSet=!0}}function setColours(t,e=1){colourVal=e;let o=0,r=1/0,s=0,l=0,i=[[],[],[],[],[]];Object.keys(t).forEach(e=>{null!==t[e]&&(r=Math.min(r,t[e]),o=Math.max(o,t[e]))}),o=10*Math.round(Math.ceil(o/10)),r=10*Math.round(Math.floor(r/10)),s=o-r,l=s/4,Object.keys(t).forEach(e=>{if("ZA-UN"!==e){let r=t[e];o-l<r&&r<=o?i[4].push(e):o-2*l<=r?i[3].push(e):o-3*l<=r?i[2].push(e):o-4*l<r?i[1].push(e):i[0].push(e)}}),console.log("ANSWERS:",i),colourCountries(i,e),legendSetup(o,r,l)}function setProvs(t,e,o){provCase=t,provDeath=e,provRecoveries=o,console.log("Recovs 1:",o),setupSideBCards()}function CommaFormatted(t){var e=parseInt(t);if(isNaN(e))return"N/A";var o="";e<0&&(o="-"),e=Math.abs(e);for(var r=new String(e),s=[];r.length>3;){var l=r.substr(r.length-3);s.unshift(l),r=r.substr(0,r.length-3)}return r.length>0&&s.unshift(r),t=o+(t=r=s.join(","))}function compareValues(t,e="desc"){return function(o,r){if(!o.hasOwnProperty(t)||!r.hasOwnProperty(t))return 0;const s="string"==typeof o[t]?o[t].toUpperCase():o[t],l="string"==typeof r[t]?r[t].toUpperCase():r[t];let i=0;try{s>l?i=1:s<l&&(i=-1)}catch(t){console.log("Error",t),console.log("-",s)}return"desc"===e?-1*i:i}}function setupSideBCards(){let t;for(const[e,o]of Object.entries(provinceList))t={name:e,cases:provCase[o],deaths:provDeath[o],recoveries:provRecoveries[o]},cardList.push(t);populateSideCards(cardList.sort(compareValues("cases")))}function populateSideCards(t){let e,o=0,r=$("#mapContainer .card");console.log("Cards",r),t.forEach(t=>{console.log("Counter",o),e=r[o].children[1].children[0].children,r[o].firstElementChild.firstElementChild.innerText=t.name,e[0].innerText=CommaFormatted(t.cases),e[2].innerText=CommaFormatted(t.deaths),e[4].innerText=CommaFormatted(t.recoveries),o++})}triggers=document.getElementsByClassName("keyText"),Object.values(triggers).forEach(t=>{x=t.getAttribute("x"),y=t.getAttribute("y"),t.setAttribute("x",x-xPen),t.setAttribute("y",y-yPen)}),triggers=document.getElementsByClassName("key legend"),Object.values(triggers).forEach(t=>{x=t.getAttribute("x"),y=t.getAttribute("y"),t.setAttribute("x",x-xPen),t.setAttribute("y",y-yPen)}),x=$("#legTitle").attr("x"),y=$("#legTitle").attr("y"),$("#legTitle").attr({x:-x-xPen,y:y-yPen}),x=$(".lightBack").attr("x"),y=$(".lightBack").attr("y"),$(".lightBack").attr({x:x-xPen,y:y-yPen}),console.log("MAX HEIGHT:",$("#svg-1").height()+Number($("#svgColumn").css("padding-top").split(/\D/)[0])),$("#provStatsContainer").css("max-height",$("#svg-1").height()+2*parseInt($("#svgColumn").css("padding-top"))),$(window).resize(()=>{$("#provStatsContainer").css("max-height",$("#svg-1").height()+2*parseInt($("#svgColumn").css("padding-top")))}),$(document).ready(()=>{$((function(){$(".scroll-pane").jScrollPane({showArrows:!0,resizeSensor:!0})})),$(".toggle.button.map").click(t=>{console.log("you clicked me!"),$("#svgColumn").toggleClass("ten wide"),$("#svgColumn").toggleClass("fourteen wide svgFocus"),$("#provStatsContainer").toggleClass("sidebarHidden"),$("#hideIcon").toggleClass("fa-rotate-180")}),$("#filterC").click(t=>{console.log("you clicked me to filter!"),setColours(provCase,1),populateSideCards(cardList.sort(compareValues("cases")))}),$("#filterD").click(t=>{console.log("you clicked me to filter!"),setColours(provDeath,2),populateSideCards(cardList.sort(compareValues("deaths")))}),$("#filterR").click(t=>{console.log("you clicked me to filter!"),setColours(provRecoveries,3),populateSideCards(cardList.sort(compareValues("recoveries")))}),$("#filterC2").click(t=>{console.log("you clicked me to filter!"),setColours(provCase,1),populateSideCards(cardList.sort(compareValues("cases")))}),$("#filterD2").click(t=>{console.log("you clicked me to filter!"),setColours(provDeath,2),populateSideCards(cardList.sort(compareValues("deaths")))}),$("#filterR2").click(t=>{console.log("you clicked me to filter!"),setColours(provRecoveries,3),populateSideCards(cardList.sort(compareValues("recoveries")))})});